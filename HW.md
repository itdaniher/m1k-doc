The ADALM1000 is a learning tool designed to make interacting with the world around you easier and more intuitive. Offering two analog channels, it allows you to source and measure waveforms in voltage or current, easily characterising arbitrary systems in terms of voltage vs current, over time, and over frequency. To offer this functionality, it uses a number of building blocks to take the fixed 5V supply and digital interface of USB and offer voltage and current operation from 0v to 5v, from -200mA to 200mA, with precision and accuracy better than 100uV, 100uA, and 10uS.

USB is a high complexity, high speed digital interface designed for PC peripherals, offering a number of defailt device types and communication schemes. While tremendously useful for the "last inches" of interface between a host PC and the M1K, the pieces of the M1K responsible for converting between analog values and digital words (analog-digital converters (ADC) and digital-analog converters (DAC)) use simpler, less robust communication schemes necessitating "glue" between a computer and the analog systems for voltage/current measurement and control. On the M1K, this glue is a microcontroller using a CPU designed by ARM (Cortex M3), with peripherals and software designed by Atmel - part number ATSAM3U2C.

The SAM3U is a great, affordable part for this USB-everything bridge position, used similarly in other products including the [4pi](https://0xfb.com/shop.html) RepRap 3d printer controller and the [osmosdr](http://sdr.osmocom.org/trac/)). The manufacturer offers a free (gratis) software framework for working with both USB and the other functionality of the part which was used extensively to create the M1K's firmware, the program loaded on each M1K at the factory.

In addition to the three serial peripheral interfaces (SPI busses) used for the M1K's two ADCs and DAC, the SAM3U also offers

 * timer-counters used for controlling 'when' the data converters sample
 * pulse-width modulation, used to set the unique LED color of each M1K on the three-channel (RGB) LED
 * two-wire interface, similar to SMBUS or I2C, used as a low-speed communication network between the SAM3U controller and other "housekeeping" components
 * digital input-output pins used for both the user-accessible programmable IO pins and to control the internal switches used in the analog frontend
 * 32 kilobytes SRAM, allowing for local data buffering and the potential for loading user-supplied software directly on to the device
 * 128 kilobytes NAND flash memory, allowing for the storage of the firmware program and the potential for data logging without use of a PC.

The SAM3U is only one of the pieces sitting between the USB connector and the analog components used for the front-end interface. Besides mapping between digital protocols, there is one more big problem to solve before we can build the analog system: power.

The USB specification (available from the USB implementers forum) is a 600+ page document describing every aspect of the ideal operation of a USB2.0 device. It requires that attached devices consume less than 500mA from the provided voltage supply, which is allowed to range from as high as 5.25v to as low as 4.40v - a wide span clearly unacceptable for a precision tool! Additionally, the power available on USB ports can vary widely in terms of both electrical noise and electrical protection. An [out-of-spec device]() attached to the shared USB bus can throw tens or even hundreds of millivolts of noise onto the voltage supply. A poorly crafted computer may not handle overcurrent conditions on a USB bus with anything more than an immediate and complete power-off, or worse, permenantly disabling a USB port. It would be unfortunate if using the M1K on an old computer degraded the accuracy of measurements and unacceptable if making mistakes during the normal operation of the device put the attached computer at risk of damage or lost data. To address these issues and provide protected, low noise voltage supplies to the analog frontend, a sophisticated supply chain as designed to ensure that regardless of input, the full 0-5v range is available at the output, and regardless of shorting or overvolting the device, the host PC is not exposed to unacceptable risk.

The M1K power chain consists of a grand total of three linear voltage regulators, two switching voltage regulators, a "hot-swap" controller, and a precision reference. 
