The analog frontend of the M1K is built around a single control loop per channel, with an analog switch to change between voltage and current control, and another analog switch to control the characteristics of the channel output. The analog control loop works to servo a measured parameter against an input signal from a digital to analog converter. The loop is built from several discrete components, each vital and carefully selected for the application at hand. The loop needs to offer at least one watt of electrical power supplied to or sourced by an external system, with high bandwidth in order to achieve the targetted output of signals up to a few hundred kilohertz. Moreover, the loop needs to offer low noise and high precision operation matching the selected 16b data converters. Balancing these parameters lead to the separation of the loop feedback control and power output stages. The power stage was built from a high ouptut current driver part - due to the limited input voltage range and nonzero voltage drop even at low control, the driver is configured as a noninverting amplifier with a gain of two, referenced to a high precision 2.5v supply. As, in this configuration, the power stage sinks current to the 2.5v rail, and precision references capable of symmetric performance, both sinking and sourcing current are expensive, the reference producing the 2.5v supply is biased with a small (500o) pulldown resistor to preserve correct performance of (the other components sharing) the reference. 

This nonverting power amplifier stage uses a current feedback architecture to achieve the high bandwidth and power it offers. This topology mimics that of more traditional voltage-feedback parts, with a few additional caveats. The presence of even femto or picofarads of parasitic capacitance, combined with the high bandwidth required of an ideal power amplifier stage readily produces high frequency oscillations unless a series R-C feedback network is added as a highpass filter in feedback, reducing the overall high frequency gain of the amplifier, but preserving stability for all loads. A two ohm series resistor is added to the output of the power amplifier to set the minimum output impedance of the device, protecting both the m1000 and any attached system from overcurrent conditions.

The power amplifier is wrapped in a high precision rail-to-rail opamp with low voltage offset on both the input and output. The ADA4661 serves as alternatively a unity gain current amplifier against the output of the AD8210 current-sense amplifier described [elsewhere.] The ADG719 CMOS analog switch alternatively connects the current sense feedback or voltage sense feedback to the inverting input of the servo amp. 

The servo amplifier is relatively painless in comparison, but careful consideration was dedicated to ensuring the system behavior while forcing a current on a load representing an extreme high or low of noise or impedance. An analog potentiometer functions as a programmable all-pass filter, offering a certain amount of control of the frequency response of the loop, with adjustable high frequency gain or attenuation. This allows a current to be sourced with increased precision even on high impedance devices like large inductors at t=0, where a small perturbance can easily result in high amplitude, high-rate-of-change sense signals.



